{% extends "base.html" %}

{% block title %}{{ project.title }}{% endblock %}

{% block content %}
    <div class="card mb-4">
        {% if project.image_filename %}
            <img src="{{ url_for('static', filename='uploads/' ~ project.image_filename) }}" class="card-img-top" alt="{{ project.title }}">
        {% elif project.image_url %}
            <img src="{{ project.image_url }}" class="card-img-top" alt="{{ project.title }}">
        {% endif %}
        <div class="card-body">
            <h3 class="card-title">{{ project.title }}</h3>
            <p class="card-text">{{ project.description }}</p>
            <a href="{{ request.referrer or url_for('home') }}">Назад</a>
        </div>
    </div>

    <h4 class="mt-4">Комментарии</h4>

    {% if comments %}
        {% for comment in comments %}
            <div class="border p-2 mb-2 rounded">
                <strong>{{ comment.user.username }}</strong>
                <small class="text-muted">{{ comment.created_at.strftime('%d.%m.%Y %H:%M') }}</small>
                <p class="mb-1">{{ comment.content }}</p>
            </div>
        {% endfor %}
    {% else %}
        <p>Комментариев пока нет.</p>
    {% endif %}

    {% if session.user_id %}
        <form method="POST" class="mt-3">
            <textarea name="content" class="form-control" rows="3" placeholder="Оставьте комментарий..."></textarea>
            <button type="submit" class="btn btn-primary mt-2">Отправить</button>
        </form>
    {% else %}
        <p><a href="{{ url_for('login') }}">Войдите</a>, чтобы оставить комментарий.</p>
    {% endif %}
{% endblock %}
